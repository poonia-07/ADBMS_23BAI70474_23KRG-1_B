--EASY---


CREATE TABLE EMP(EMPID INT PRIMARY KEY  , ENAME VARCHAR(MAX) , DEPARTMENT VARCHAR(MAX) , MANAGERID INT)

ALTER TABLE EMP
ADD CONSTRAINT FK_EMP FOREIGN KEY (MANAGERID) REFERENCES EMP(EMPID)

INSERT INTO EMP (EMPID, ENAME, DEPARTMENT, MANAGERID) VALUES
									(101, 'Alice Sharma', 'HR', NULL),
									(102, 'Ravi Kumar', 'Finance', 101),
									(103, 'Priya Singh', 'Engineering', 101),
									(104, 'Vikram Joshi', 'Marketing', 102),
									(105, 'Ankit Verma', 'HR', 102),
									(106, 'Harsh', 'HR', 106)

SELECT * FROM EMP


SELECT E1.ENAME AS [EMPLOYEE NAME],  E1.DEPARTMENT AS [DEPARTMENT] , E2.ENAME AS [MANAGER NAME], E2.DEPARTMENT AS [MANAGER DEPT]
FROM EMP AS E1
LEFT OUTER JOIN
EMP AS E2
ON 
E1.MANAGERID = E2.EMPID


---HARD----

CREATE TABLE Year_tbl (
    ID INT,
    YEAR INT,
    NPV INT
);

CREATE TABLE Queries (
    ID INT,
    YEAR INT
);

INSERT INTO Year_tbl (ID, YEAR, NPV)
VALUES
(1, 2018, 100),
(7, 2020, 30),
(13, 2019, 40),
(1, 2019, 113),
(2, 2008, 121),
(3, 2009, 12),
(11, 2020, 99),
(7, 2019, 0);

INSERT INTO Queries (ID, YEAR)
VALUES
(1, 2019),
(2, 2008),
(3, 2009),
(7, 2018),
(7, 2019),
(7, 2020),
(13, 2019);

SELECT * FROM Year_tbl

SELECT * FROM Queries

SELECT Q.ID AS [ID], Q.YEAR AS [YEAR], ISNULL(Y.NPV,0) AS [NPV]
FROM Queries AS Q
LEFT OUTER JOIN
Year_tbl AS Y 
ON 
Q.ID = Y.ID AND Q.YEAR = Y.YEAR
